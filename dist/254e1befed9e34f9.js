import"./style.css";import*as THREE from"three";import{CSS2DObject}from"three/examples/jsm/renderers/CSS2DRenderer";import{OrbitControls}from"three/examples/jsm/controls/OrbitControls";import{DRACOLoader}from"three/examples/jsm/loaders/DRACOLoader";import{GLTFLoader}from"three/examples/jsm/loaders/GLTFLoader";const canvas=document.querySelector("canvas.webgl"),cursorCircle=document.querySelector(".cursor-circle"),navbarDetailsLink=document.querySelector(".navbar-right li:first-child a"),detailsDiv=document.querySelector(".details");navbarDetailsLink.addEventListener("click",(()=>{detailsDiv.classList.toggle("hidden")}));const sizes={width:window.innerWidth,height:window.innerHeight},scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(75,sizes.width/sizes.height);camera.position.set(.18,.145,.18),scene.add(camera);const dracoLoader=new DRACOLoader;dracoLoader.setDecoderPath("draco/");const gltfLoader=new GLTFLoader;gltfLoader.setDRACOLoader(dracoLoader);const spotLight=new THREE.AmbientLight(16777215);spotLight.position.set(1,1,0),scene.add(spotLight);const newSpotLight=new THREE.DirectionalLight(16777215);newSpotLight.position.set(0,1,0),scene.add(newSpotLight);const groundGeometry=new THREE.PlaneGeometry(500,500,1,1),groundMaterial=new THREE.MeshStandardMaterial({color:5064789,roughness:.1,metalness:.9}),ground=new THREE.Mesh(groundGeometry,groundMaterial);ground.rotation.x=-.5*Math.PI,scene.add(ground);const circularPlatformRadius=.22,circularPlatformHeight=.01,circularPlatformGeometry=new THREE.CylinderGeometry(.22,.22,.01,64),circularPlatformMaterial=new THREE.MeshStandardMaterial({color:16777215,roughness:.5,metalness:.5}),circularPlatform=new THREE.Mesh(circularPlatformGeometry,circularPlatformMaterial);let car;circularPlatform.position.y=.005,scene.add(circularPlatform),gltfLoader.load("plane.glb",(e=>{car=e.scene,scene.add(car)}));const cursor={x:0,y:0};window.addEventListener("mousemove",(e=>{const r=e.clientX,a=e.clientY;cursorCircle.style.left=`${r}px`,cursorCircle.style.top=`${a}px`}));const renderer=new THREE.WebGLRenderer({canvas});renderer.setSize(sizes.width,sizes.height);const controls=new OrbitControls(camera,canvas);window.addEventListener("dblclick",(()=>{document.fullscreenElement?document.exitFullscreen():canvas.requestFullscreen()})),window.addEventListener("resize",(()=>{sizes.width=window.innerWidth,sizes.height=window.innerHeight,camera.aspect=sizes.width/sizes.height,camera.updateProjectionMatrix(),renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2))}));const sphereMarkerMaterial=new THREE.MeshBasicMaterial({color:720640,opacity:0,transparent:!0}),rectangleMarkerMaterial=new THREE.MeshBasicMaterial({color:0,opacity:0,transparent:!0}),wheelMarkerMaterial=new THREE.MeshBasicMaterial({color:0,opacity:0,transparent:!0}),doorMarkerMaterial=new THREE.MeshBasicMaterial({color:16773120,opacity:0,transparent:!0}),windowMarkerMaterial=new THREE.MeshBasicMaterial({color:1048560,opacity:0,transparent:!0}),sphereMarkerPosition=new THREE.Vector3(.001,.03,.095),Headlight1MarkerPosition=new THREE.Vector3(.045,.052,.129),Headlight2MarkerPosition=new THREE.Vector3(-.045,.052,.129),Wheel1MarkerPosition=new THREE.Vector3(.05,.04,.09),Wheel2MarkerPosition=new THREE.Vector3(-.045,.04,.09),Wheel3MarkerPosition=new THREE.Vector3(.045,.04,-.1),Wheel4MarkerPosition=new THREE.Vector3(-.045,.04,-.1),door1MarkerPosition=new THREE.Vector3(.062,.05,-.01),door2MarkerPosition=new THREE.Vector3(-.062,.05,-.01),window1MarkerPosition=new THREE.Vector3(.062,.085,-.01),window2MarkerPosition=new THREE.Vector3(0,.085,.04),window3MarkerPosition=new THREE.Vector3(-.062,.085,-.01),interactiveParts=[{name:"Hood",description:"Hood\n\nThis is the hinged cover over the engine of any motor vehicles. A hood may contain: \n\nHood ornament: Used to symbolize car companies\n Air dam: Used to allow airflow directly into the engine\n Windshield wipers: Used to remove rain, snow, dirt, etc. \n\nThe hood release system is common on most vehicles and usually consists of an interior hood latch handle, hood release cable and hood latch assembly. The hood latch handle is usually located below the steering wheel, beside the driver seat or set into the door frame. On race cars, the hood may be held down by hood pins.",marker:createSphereMarker(sphereMarkerMaterial,sphereMarkerPosition)},{name:"Headlight1",description:"Headlamp\n\nA headlamp is a lamp attached to the front of a vehicle to illuminate the road ahead. Headlamps are also often called headlights, however, headlamp is the term for the device itself and headlight is the term for the beam of light produced and distributed by the device.\n\nHeadlamps have steadily improved throughout the automobile age, and have made a big difference in daytime and night-time traffic fatalities. Excluding cars, vehicles such as trains and aircrafts are required to have headlamps. Bicycle headlamps are often used on bicycles, and can be powered by a battery or a small generator like a bottle or hub dynamo.",marker:createRectangleMarker(rectangleMarkerMaterial,Headlight1MarkerPosition)},{name:"Headlight2",description:"Headlamp\n\nA headlamp is a lamp attached to the front of a vehicle to illuminate the road ahead. Headlamps are also often called headlights, however, headlamp is the term for the device itself and headlight is the term for the beam of light produced and distributed by the device.\n\nHeadlamps have steadily improved throughout the automobile age, and have made a big difference in daytime and night-time traffic fatalities. Excluding cars, vehicles such as trains and aircrafts are required to have headlamps. Bicycle headlamps are often used on bicycles, and can be powered by a battery or a small generator like a bottle or hub dynamo.",marker:createRectangleMarker(rectangleMarkerMaterial,Headlight2MarkerPosition)},{name:"Tire1",description:'Tire/Tyre\n\n It is a ring-shaped component that surrounds a wheels rim to transfer a vehicles load from the axle through the wheel to the ground and to provide traction on the surface over which the wheel travels. \n\nModern pneumatic tires are made with synthetic rubber, natural rubber, fabric, and wire along with carbon black and other chemical compounds. Pneumatic tires are used in vehicles such as cars, motorcycles, bicycles, buses, aircrafts, etc, whereas Metal tires are used in trains and railcars. \n\nModern Tires are based on "Pacejka Magic Formula":\n\n1) Balance\n2) Centrifugal Growth\n3) Pneumatic trail\n4) Slip angle\n5) Relaxation length\n6) Spring rate\n7) Stopping distance',marker:createNewSphereMarker(wheelMarkerMaterial,Wheel1MarkerPosition)},{name:"Tire2",description:'Tire/Tyre\n\n It is a ring-shaped component that surrounds a wheels rim to transfer a vehicles load from the axle through the wheel to the ground and to provide traction on the surface over which the wheel travels. \n\nModern pneumatic tires are made with synthetic rubber, natural rubber, fabric, and wire along with carbon black and other chemical compounds. Pneumatic tires are used in vehicles such as cars, motorcycles, bicycles, buses, aircrafts, etc, whereas Metal tires are used in trains and railcars. \n\nModern Tires are based on "Pacejka Magic Formula":\n\n1) Balance\n2) Centrifugal Growth\n3) Pneumatic trail\n4) Slip angle\n5) Relaxation length\n6) Spring rate\n7) Stopping distance',marker:createNewSphereMarker(wheelMarkerMaterial,Wheel2MarkerPosition)},{name:"Tire3",description:'Tire/Tyre\n\n It is a ring-shaped component that surrounds a wheels rim to transfer a vehicles load from the axle through the wheel to the ground and to provide traction on the surface over which the wheel travels. \n\nModern pneumatic tires are made with synthetic rubber, natural rubber, fabric, and wire along with carbon black and other chemical compounds. Pneumatic tires are used in vehicles such as cars, motorcycles, bicycles, buses, aircrafts, etc, whereas Metal tires are used in trains and railcars. \n\nModern Tires are based on "Pacejka Magic Formula":\n\n1) Balance\n2) Centrifugal Growth\n3) Pneumatic trail\n4) Slip angle\n5) Relaxation length\n6) Spring rate\n7) Stopping distance',marker:createNewSphereMarker(wheelMarkerMaterial,Wheel3MarkerPosition)},{name:"Tire4",description:'Tire/Tyre\n\n It is a ring-shaped component that surrounds a wheels rim to transfer a vehicles load from the axle through the wheel to the ground and to provide traction on the surface over which the wheel travels. \n\nModern pneumatic tires are made with synthetic rubber, natural rubber, fabric, and wire along with carbon black and other chemical compounds. Pneumatic tires are used in vehicles such as cars, motorcycles, bicycles, buses, aircrafts, etc, whereas Metal tires are used in trains and railcars. \n\nModern Tires are based on "Pacejka Magic Formula":\n\n1) Balance\n2) Centrifugal Growth\n3) Pneumatic trail\n4) Slip angle\n5) Relaxation length\n6) Spring rate\n7) Stopping distance',marker:createNewSphereMarker(wheelMarkerMaterial,Wheel4MarkerPosition)},{name:"Door1",description:"Door\n\n A car door is a type of door opening, typically hinged on its front edge, but sometimes attached by other mechanisms such as tracks, for entering and exiting a vehicle. Doors most often integrate side windows for visibility from inside the car and can be locked to secure the vehicle. \n\nCar doors may be manually operated or with power assist supplied by the vehicle. Powered doors or power doors may be found on minivans, luxury vehicles, or modified cars. The different parts of a car door are: \n\nDoor panel: It is the exterior of the door which covers the internal components.\nDoor handle: It is a handle used to open or close a door.\nPower door locks: It allows the driver to lock/unlock a car door using a button or a switch.\nInterior storage components: It allows the driver or passengers to store different things.",marker:createBoxMaterialMarker(doorMarkerMaterial,door1MarkerPosition)},{name:"Door2",description:"Door\n\n A car door is a type of door opening, typically hinged on its front edge, but sometimes attached by other mechanisms such as tracks, for entering and exiting a vehicle. Doors most often integrate side windows for visibility from inside the car and can be locked to secure the vehicle. \n\nCar doors may be manually operated or with power assist supplied by the vehicle. Powered doors or power doors may be found on minivans, luxury vehicles, or modified cars. The different parts of a car door are: \n\nDoor panel: It is the exterior of the door which covers the internal components.\nDoor handle: It is a handle used to open or close a door.\nPower door locks: It allows the driver to lock/unlock a car door using a button or a switch.\nInterior storage components: It allows the driver or passengers to store different things.",marker:createBoxMaterialMarker(doorMarkerMaterial,door2MarkerPosition)},{name:"Window1",description:"Window\n\nVehicle window includes windscreens, side and rear windows, and glass panel roofs.\n\nWindscreen: It is the front window which provides visibility while protecting the driver and passengers from debris and other elements.\nSide and rear windows: They are the windows placed on the side and rear of a vehicle. They can be raised or lowered using a hand-turned crank(old vehicles) or a button or a switch(modern vehicles).\nGlass panel roof: It is placed at the top of a car, as a sunroof or a moonroof. In modern vehicles, the panel roof can be retracted to let sun rays enter the vehicle. ",marker:createWindow1MaterialMarker(windowMarkerMaterial,window1MarkerPosition)},{name:"Window2",description:"Window\n\nVehicle window includes windscreens, side and rear windows, and glass panel roofs.\n\nWindscreen: It is the front window which provides visibility while protecting the driver and passengers from debris and other elements.\nSide and rear windows: They are the windows placed on the side and rear of a vehicle. They can be raised or lowered using a hand-turned crank(old vehicles) or a button or a switch(modern vehicles).\nGlass panel roof: It is placed at the top of a car, as a sunroof or a moonroof. In modern vehicles, the panel roof can be retracted to let sun rays enter the vehicle. ",marker:createWindow2MaterialMarker(windowMarkerMaterial,window2MarkerPosition)},{name:"Window3",description:"Window\n\nVehicle window includes windscreens, side and rear windows, and glass panel roofs.\n\nWindscreen: It is the front window which provides visibility while protecting the driver and passengers from debris and other elements.\nSide and rear windows: They are the windows placed on the side and rear of a vehicle. They can be raised or lowered using a hand-turned crank(old vehicles) or a button or a switch(modern vehicles).\nGlass panel roof: It is placed at the top of a car, as a sunroof or a moonroof. In modern vehicles, the panel roof can be retracted to let sun rays enter the vehicle. ",marker:createWindow1MaterialMarker(windowMarkerMaterial,window3MarkerPosition)}];function createSphereMarker(e,r){const a=new THREE.SphereGeometry(.06,64,64,Math.PI,Math.PI),o=new THREE.Mesh(a,e);return o.rotation.x=Math.PI/2,o.position.copy(r),scene.add(o),o}function createRectangleMarker(e,r){const a=new THREE.SphereGeometry(.01,32,32),o=new THREE.Mesh(a,e);return o.position.copy(r),scene.add(o),o}function createNewSphereMarker(e,r){const a=new THREE.SphereGeometry(.024,45,45),o=new THREE.Mesh(a,e);return o.position.copy(r),scene.add(o),o}function createBoxMaterialMarker(e,r){const a=new THREE.BoxGeometry(.09,.04,.005),o=new THREE.Mesh(a,e);return o.rotateY(Math.PI/2),o.position.copy(r),scene.add(o),o}function createWindow1MaterialMarker(e,r){const a=new THREE.BoxGeometry(.06,.03,.004),o=new THREE.Mesh(a,e);return o.rotateY(Math.PI/2),o.position.copy(r),scene.add(o),o}function createWindow2MaterialMarker(e,r){const a=new THREE.BoxGeometry(.05,.03,.005),o=new THREE.Mesh(a,e);return o.position.copy(r),scene.add(o),o}function onClick(e){const r=new THREE.Vector2;r.x=e.clientX/window.innerWidth*2-1,r.y=-e.clientY/window.innerHeight*2+1;const a=new THREE.Raycaster;a.setFromCamera(r,camera);const o=a.intersectObjects(interactiveParts.map((e=>e.marker)));if(o.length>0){const e=o[0].object,r=interactiveParts.find((r=>r.marker===e));r&&showInformation(r.description)}}window.addEventListener("click",onClick);let isUIVisible=!1;function showInformation(e){const r=document.createElement("div");r.className="tooltip",r.textContent=e,document.body.appendChild(r),window.addEventListener("click",(()=>{document.body.removeChild(r)}))}const detailLines=[],lineMaterial=new THREE.LineBasicMaterial({color:0,linewidth:10}),points1=[new THREE.Vector3(0,0,0),new THREE.Vector3(1,1,1),new THREE.Vector3(.1,.1,.05)],points2=[new THREE.Vector3(0,0,0),new THREE.Vector3(1,0,0)];points1.forEach((e=>{e.y-=0})),points2.forEach((e=>{e.y-=.2}));const lineGeometry1=(new THREE.BufferGeometry).setFromPoints(points1),lineGeometry2=(new THREE.BufferGeometry).setFromPoints(points2),line1=new THREE.Line(lineGeometry1,lineMaterial);line1.visible=!1,scene.add(line1),detailLines.push(line1);const line2=new THREE.Line(lineGeometry2,lineMaterial);function toggleDetailLines(){const e=detailLines[0].visible;detailLines.forEach((r=>{r.visible=!e}))}line2.visible=!1,scene.add(line2),detailLines.push(line2);const starPositions=[],numStars=1e3;for(let e=0;e<1e3;e++){const e=2e3*Math.random()-1e3,r=2e3*Math.random()-1e3,a=2e3*Math.random()-1e3;starPositions.push({x:e,y:r,z:a})}const starSpheres=[],starMaterial=new THREE.MeshBasicMaterial({color:16777215});for(const e of starPositions){const r=new THREE.SphereGeometry(1,16,16),a=new THREE.Mesh(r,starMaterial);a.position.set(e.x,e.y,e.z),starSpheres.push(a),scene.add(a)}starSpheres.forEach((e=>{e.renderOrder=-1}));const keyboard={ArrowUp:!1,ArrowLeft:!1,ArrowRight:!1,ArrowDown:!1},handleKeyDown=e=>{"ArrowUp"===e.key&&(keyboard.w=!0),"ArrowLeft"===e.key&&(keyboard.a=!0),"ArrowRight"===e.key&&(keyboard.d=!0),"ArrowDown"===e.key&&(keyboard.s=!0)},handleKeyUp=e=>{"ArrowUp"===e.key&&(keyboard.w=!1),"ArrowLeft"===e.key&&(keyboard.a=!1),"ArrowRight"===e.key&&(keyboard.d=!1),"ArrowDown"===e.key&&(keyboard.s=!1)};function resetCameraPosition(){camera.position.set(.18,.145,.18)}window.addEventListener("keydown",handleKeyDown),window.addEventListener("keyup",handleKeyUp),window.addEventListener("keydown",(e=>{"r"===e.key&&resetCameraPosition()}));const animate=()=>{const e=43e-5*Date.now();camera.position.x=.31*Math.cos(e),camera.position.z=.31*Math.sin(e),camera.position.y=.13,camera.lookAt(circularPlatform.position),keyboard.w&&(camera.position.copy(car.position),camera.position.y+=.31,camera.lookAt(car.position),car.rotation.y+=2*Math.PI),keyboard.a&&(camera.position.copy(car.position),camera.position.x+=.31,camera.position.y=.12,camera.lookAt(car.position)),keyboard.d&&(camera.position.copy(car.position),camera.position.x-=.31,camera.position.y=.12,camera.lookAt(car.position)),keyboard.s&&(camera.position.copy(car.position),camera.lookAt(car.position),camera.position.y=.1,camera.position.z+=.37),renderer.render(scene,camera),controls.update(),requestAnimationFrame(animate)};animate();const glowLight=new THREE.AmbientLight(2039842);scene.add(glowLight),window.addEventListener("keydown",(e=>{if("c"===e.key||"C"===e.key){const e=16777215*Math.random();glowLight.color.set(e)}})),window.addEventListener("keydown",(e=>{if("r"===e.key||"R"===e.key){const e=2039842;glowLight.color.set(e)}}));